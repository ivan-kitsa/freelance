"use strict";const WREATHS=[{name:"В-1",description:"высота 90 см, ширина 49 см, <br/> высота с ножками 122 см",cost:1.67},{name:"В-2",description:"высота 104 см, ширина 57 см, <br/> высота с ножками 136 см",cost:1.87},{name:"В-3",description:"высота 118 см, ширина 68 см, <br/> высота с ножками 150 см",cost:2.17},{name:"В-4",description:"высота 132 см, ширина 74 см, <br/> высота с ножками 164 см",cost:2.4},{name:"В-5",description:"высота 98 см, ширина 58 см, <br/> высота с ножками 130 см",cost:2.35},{name:"В-6",description:"высота 132 см, ширина 66 см, <br/> высота с ножками 164 см",cost:2.74},{name:"В-7",description:"высота 103 см, ширина 70 см, <br/> высота с ножками 135 см",cost:4},{name:"В-8",description:"высота 116 см, ширина 76 см, <br/> высота с ножками 148 см",cost:4.3}],BASKETS=[{name:"К-1",description:"высота 55 см, ширина 19 см",cost:1.55},{name:"К-2",description:"высота 115 см, ширина 50 см",cost:4.22},{name:"К-3",description:"высота 63 см, ширина 19 см",cost:1.62},{name:"К-4",description:"высота 70 см, ширина 29 см",cost:2.83},{name:"К-5",description:"высота 78 см, ширина 47 см",cost:3.05},{name:"К-6",description:"высота 88 см, ширина 30 см",cost:2.94},{name:"К-7",description:"высота 89 см, ширина 22 см",cost:2.5},{name:"К-8",description:"высота 36 см, ширина 23 см",cost:1.26},{name:"К-9",description:"высота 78 см, ширина 39 см",cost:2.72},{name:"К-10",description:"высота 19 см, ширина 33 см",cost:1.27},{name:"К-11",description:"высота 92 см, ширина 42 см",cost:3.72},{name:"К-12",description:"высота 96 см, ширина 38 см",cost:3.22}];let WREATHS_LIST,BASKETS_LIST,timer;document.addEventListener("DOMContentLoaded",()=>{dataCreator(),productListCreator()});const debounce=(t,e)=>{clearTimeout(timer),timer=setTimeout(t,e)},$=t=>document.getElementById(t),dateProvider=()=>{const t=new Date,e=["января","февраля","марта","апреля","мая","июня","июля","августа","сентября","октября","ноября","декабря"][t.getMonth()];return String(t.getDate()).padStart(2,"0")+"\n"+e+"\n"+t.getFullYear()},dataCreator=()=>{WREATHS_LIST=WREATHS.map((t,e)=>({...t,id:e+1,allCost:t.cost,discountPercent:0,count:1,inBasket:!1,type:"wreath"})),BASKETS_LIST=BASKETS.map((t,e)=>({...t,id:e+1+WREATHS_LIST.length,allCost:t.cost,discountPercent:0,count:1,inBasket:!1,type:"basket"})),PAGE_OPTIONS.currentList=WREATHS_LIST},PAGE_OPTIONS={currentList:[],basketList:[],basketIsOpen:!1,privacyConfirmed:!1,price:0},basketButton=$("basket-button"),basketProductsWrapper=$("basket-products-wrapper"),basketWrapper=$("basket-wrapper"),catalogWrapper=$("catalog"),priceField=$("price"),preloader=$("preloader"),body=document.querySelector("body"),setProductType=t=>{const e=t.target,n=document.querySelectorAll(".product-type");if(!e.classList.contains("active")){switch(t.target.id){case"wreaths":PAGE_OPTIONS.currentList=WREATHS_LIST;break;case"baskets":PAGE_OPTIONS.currentList=BASKETS_LIST}n.forEach(t=>{t.classList.remove("active")}),e.classList.add("active"),productListCreator()}},productListCreator=()=>{const t=PAGE_OPTIONS.currentList.map(t=>`<div class='product' id=${t.id}>\n            <div class='photo-wrapper'>\n                <picture>\n                   <source srcset='./images/products/${t.type}/${t.name}.webp' type='image/webp'>\n                   <img src='./images/products/${t.type}/${t.name}.jpg' alt=${t.name}>\n                </picture>\n            </div>\n            <h3>${t.name}</h3>\n            <p class='description'>${t.description}</p> \n            <div class='cost-wrapper'>\n                <span id='discount-area-${t.id}'>\n                    Общая стоимость: \n                    ${t.discountPercent?`<span class='discount-flag'>-${t.discountPercent}%</span>`:""} \n                </span>\n                <span id='all-cost-${t.id}'>${t.allCost} BYN</span>\n            </div>\n            <div class='count-wrapper'>\n                <span>Количество:</span>\n                <div class='counter'>\n                    <input type='number' id='count-${t.id}' value=${t.count} class='${t.type}'\n                           oninput='onInputCounter(event)' onblur='onBlurCounter(event)'>\n                    <img src='./images/minus.svg' alt='-' onclick='onButtonCounter(event)' id='${t.type}-${t.id}-down'>\n                    <img src='./images/plus.svg' alt='+' onclick='onButtonCounter(event)' id='${t.type}-${t.id}-up'>\n                </div>\n            </div>\n            <div class='button-wrapper' id='button-wrapper-${t.id}'>\n                ${t.inBasket?`<button class='button checked' onclick='removeFromBasket(event)' id='${t.type}-${t.id}-card-remove'>В корзине</button>`:`<button class='button' onclick='setToBasket(${t.id})'>Добавить в корзину</button>`}\n            </div>\n        </div>`);catalogWrapper.innerHTML=t.join("")},basketListCreator=()=>{const t=PAGE_OPTIONS.basketList.map(t=>`<div class='basket-product' id='basket-${t.id}'>\n            <div class='photo-wrapper'>\n                <picture>\n                   <source srcset='./images/products/${t.type}/${t.name}.webp' type='image/webp'>\n                   <img src='./images/products/${t.type}/${t.name}.jpg' alt=${t.name}>\n                </picture>\n            </div>\n            <div class='info-wrapper'>\n                <h3>${t.name}</h3>\n                <div class='cost-wrapper'>\n                    <span id='basket-discount-area-${t.id}'>\n                        Общая стоимость:\n                        ${t.discountPercent?`<span class='discount-flag'>-${t.discountPercent}%</span>`:""} \n                    </span>\n                    <span class='basket-all-cost' id='basket-all-cost-${t.id}'>${t.allCost} BYN</span>\n                </div>\n                <div class='count-wrapper'>\n                    <span>Количество:</span>\n                    <div class='counter'>\n                        <input type='number' id='basket-count-${t.id}' value=${t.count} class='${t.type}'\n                               oninput='onInputCounter(event)' onblur='onBlurCounter(event)'>\n                        <img src='./images/minus.svg' alt='-' onclick='onButtonCounter(event)' id='${t.type}-${t.id}-down'>\n                        <img src='./images/plus.svg' alt='+' onclick='onButtonCounter(event)' id='${t.type}-${t.id}-up'>\n                    </div>\n                </div>\n            </div>\n            <div class='remove-wrapper'>\n                <img src='./images/remove.svg' alt='remove' onclick='removeFromBasket(event)' id='${t.type}-${t.id}-basket-remove'>\n            </div>\n        </div>`);basketProductsWrapper.innerHTML=t.join("")},onBlurCounter=t=>{if(isNaN(parseInt(t.target.value))){const e=t.target.className,n=t.target.id.replace("count-","").replace("basket-",""),i=PAGE_OPTIONS.basketList.find(t=>t.id===+n),a=getProductFromList(e,n);t.target.value=1,a.count=1,i&&(i.count=1),setCount(a,1),i&&setCount(i,1)}},onInputCounter=t=>{const e=t.target.value,n=t.target.className,i=t.target.id.replace("count-","").replace("basket-",""),a=PAGE_OPTIONS.basketList.find(t=>t.id===+i),o=getProductFromList(n,i);setCount(o,+e),a&&setCount(a,+e)},onButtonCounter=t=>{const e=t.target.id.split("-"),n=e[0],i=e[1],a=e[2],o=$(`count-${i}`),r=$(`basket-count-${i}`),l=PAGE_OPTIONS.basketList.find(t=>t.id===+i),s=getProductFromList(n,i);let d;switch(a){case"up":d=+s.count+1;break;case"down":d=+s.count-1}d&&(o&&(o.value=d),r&&(r.value=d),setCount(s,+d),l&&setCount(l,+d))},getProductFromList=(t,e)=>{switch(t){case"wreath":const n=Number(e-1);return WREATHS_LIST[n];case"basket":const i=Number(e-1-WREATHS_LIST.length);return BASKETS_LIST[i]}},setCount=(t,e)=>{const n=t.count,i=$(`count-${t.id}`),a=$(`basket-count-${t.id}`),o=!!PAGE_OPTIONS.basketList.find(e=>e.id===t.id);return isNaN(e)||0===e?(t.count=n,i&&(i.value=""),a&&(a.value=""),void costControl(t,n)):e>9999?(t.count=n,i&&(i.value=n),a&&(a.value=n),void costControl(t,n)):(t.count=e,i&&(i.value=e),a&&(a.value=e),costControl(t,e),void(o&&priceControl()))},priceControl=()=>{PAGE_OPTIONS.price=0,PAGE_OPTIONS.basketList.forEach(t=>{PAGE_OPTIONS.price+=t.allCost}),priceField.innerHTML=`${PAGE_OPTIONS.price.toFixed(2)} BYN`},costControl=(t,e)=>{const n=$(`discount-area-${t.id}`),i=$(`basket-discount-area-${t.id}`),a=$(`all-cost-${t.id}`),o=$(`basket-all-cost-${t.id}`);e>=100?(t.discountPercent=5,t.allCost=+(.95*t.cost*e).toFixed(2).replace(".00",""),n&&(n.innerHTML=`Общая стоимость: <span class='discount-flag'>-${t.discountPercent}%</span>`),i&&(i.innerHTML=`Общая стоимость: <span class='discount-flag'>-${t.discountPercent}%</span>`)):(t.discountPercent=0,t.allCost=+(t.cost*e).toFixed(2).replace(".00",""),n&&(n.innerHTML="Общая стоимость:"),i&&(i.innerHTML="Общая стоимость:")),a&&(a.innerHTML=`${e?t.allCost:t.cost} BYN`),o&&(o.innerHTML=`${e?t.allCost:t.cost} BYN`)},setToBasket=t=>{const e=PAGE_OPTIONS.currentList.find(e=>e.id===t),n=$(`button-wrapper-${t}`);e.inBasket=!0,n.innerHTML=`<button class='button checked' onclick='removeFromBasket(event)' id='${e.type}-${e.id}-card-remove'>В корзине</button>`,PAGE_OPTIONS.basketList=[...PAGE_OPTIONS.basketList,e],PAGE_OPTIONS.basketList.length&&!basketButton.classList.contains("active")&&basketButton.classList.add("active"),priceControl(),basketAnim(),submitValidator()},removeFromBasket=t=>{const e=t.target.id.split("-"),n=e[0],i=e[1],a="basket"===e[2],o=("wreath"===n?WREATHS_LIST:BASKETS_LIST).find(t=>t.id===+i),r=$(`button-wrapper-${i}`),l=$(`basket-${i}`);r&&(r.innerHTML=`<button class='button' onclick={setToBasket(${i})}>Добавить в корзину</button>`),l&&l.remove(),a&&refreshProduct(o),o.inBasket=!1,PAGE_OPTIONS.basketList=PAGE_OPTIONS.basketList.filter(t=>t.id!==+i),PAGE_OPTIONS.basketList.length||(!a&&basketButton.classList.remove("active"),basketProductsWrapper.innerHTML="<div class='basket-product'><span class='empty-message'>Ваша корзина пуста</span></div>"),priceControl(),submitValidator()},refreshProduct=t=>{t.inBasket=!1,t.count=1,t.allCost=t.cost,t.discountPercent=0},basketAnim=()=>{basketButton.classList.remove("animate"),setTimeout(()=>{basketButton.classList.add("animate")},10)},basketHandler=t=>{const e=t.target.classList;PAGE_OPTIONS.basketIsOpen?(productListCreator(),e.remove("opened"),basketWrapper.classList.remove("opened"),body.classList.remove("overflow"),PAGE_OPTIONS.basketIsOpen=!1,PAGE_OPTIONS.basketList.length||basketButton.classList.remove("active")):(basketListCreator(),e.add("opened"),basketWrapper.classList.add("opened"),body.classList.add("overflow"),PAGE_OPTIONS.basketIsOpen=!0)},formData={companyName:null,email:null,phone:null,unp:null,country:null,city:null,index:null,address:null,bill:null,bank:null,bic:null,delivery:!1,deliveryCountry:null,deliveryCity:null,deliveryIndex:null,deliveryAddress:null},getValue=t=>{const e=t.target.value,n=t.target.id;inputValidator(t.target),formData[n]=e,e.length?t.target.classList.add("active"):t.target.classList.remove("active")},inputValidator=t=>{const e=t.required,n=t.value;!e||n.length?t.classList.remove("error"):t.classList.add("error")},deliveryHandler=t=>{const e=$("delivery-wrapper"),n=t.target.checked;[$("deliveryCountry"),$("deliveryCity"),$("deliveryAddress")].forEach(t=>{t.required=n}),formData.delivery=n,n?e.classList.remove("hidden"):e.classList.add("hidden")},preloadHandler=t=>{t?preloader.classList.add("active"):preloader.classList.remove("active")},privacyHandler=t=>{PAGE_OPTIONS.privacyConfirmed=t.target.checked,submitValidator()},submitValidator=()=>{const t=$("submit");t&&(PAGE_OPTIONS.basketList.length&&PAGE_OPTIONS.privacyConfirmed?t.classList.remove("disabled"):t.classList.add("disabled"))},getOrderIndex=t=>{t.preventDefault();const e=new XMLHttpRequest;e.open("GET","https://api.countapi.xyz/hit/moth.by/order"),e.responseType="json",e.onload=function(){console.log(`order index: ${this.response.value}`),preloadHandler(!0),sendPayment(this.response.value)},e.send()},openThanksPopup=()=>{document.querySelector(".thanks-popup-wrapper").classList.remove("hidden"),preloadHandler(!1)},reloadPage=()=>{document.location.reload()},createDoc=t=>{const{Packer:e,Document:n,Table:i,Paragraph:a,TextRun:o,ImageRun:r,WidthType:l,HeadingLevel:s,TableCell:d,TableRow:c,HorizontalPositionAlign:p,HorizontalPositionRelativeFrom:A,VerticalPositionAlign:g,VerticalPositionRelativeFrom:E,AlignmentType:b,VerticalAlign:m,BorderStyle:h}=docx,u=[new c({children:[new d({children:[new a({children:[new o({text:"№",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:4,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Наименование товара",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:30,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Кол-во (шт.)",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Цена",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Сумма",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Ставка НДС, %",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Сумма \r НДС",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"Всего с НДС",font:"Arial",bold:!0,size:18})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}})]})];PAGE_OPTIONS.basketList.forEach((t,e)=>{u.push(new c({children:[new d({children:[new a({children:[new o({text:(e+1).toString(),font:"Arial"})],spacing:{before:100,after:100},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:4,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:t.name,font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:30,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:t.count.toString(),font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:t.cost.toFixed(2).toString(),font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:t.allCost.toFixed(2).toString(),font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:"20%",font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:(.2*t.allCost).toFixed(2).toString(),font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:(t.allCost+.2*t.allCost).toFixed(2).toString(),font:"Arial"})],spacing:{before:200,after:200},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}})]}))});const w=new c({children:[new d({children:[new a({text:"",spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:4,type:l.PERCENTAGE},borders:{top:{style:h.NONE,color:"white"},bottom:{style:h.NONE,color:"white"},left:{style:h.NONE,color:"white"},right:{style:h.NONE,color:"white"}}}),new d({children:[new a({text:"",spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:30,type:l.PERCENTAGE},borders:{top:{style:h.NONE,color:"white"},bottom:{style:h.NONE,color:"white"},left:{style:h.NONE,color:"white"},right:{style:h.NONE,color:"white"}}}),new d({children:[new a({text:"",spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE},borders:{top:{style:h.NONE,color:"white"},bottom:{style:h.NONE,color:"white"},left:{style:h.NONE,color:"white"},right:{style:h.NONE,color:"white"}}}),new d({children:[new a({children:[new o({text:"Итого:",font:"Arial",bold:!0})],spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE},borders:{top:{style:h.NONE,color:"white"},bottom:{style:h.NONE,color:"white"},left:{style:h.NONE,color:"white"},right:{style:h.NONE,color:"white"}}}),new d({children:[new a({children:[new o({text:PAGE_OPTIONS.price.toFixed(2).toString(),font:"Arial",bold:!0})],spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}}),new d({children:[new a({text:"",spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:10,type:l.PERCENTAGE},borders:{top:{style:h.NONE,color:"white"},bottom:{style:h.NONE,color:"white"},left:{style:h.NONE,color:"white"},right:{style:h.NONE,color:"white"}}}),new d({children:[new a({children:[new o({text:(.2*PAGE_OPTIONS.price).toFixed(2).toString(),font:"Arial",bold:!0})],spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}}),new d({children:[new a({children:[new o({text:(PAGE_OPTIONS.price+.2*PAGE_OPTIONS.price).toFixed(2).toString(),font:"Arial",bold:!0})],spacing:{after:30,before:30},alignment:b.CENTER})],verticalAlign:m.CENTER,width:{size:12,type:l.PERCENTAGE}})]});u.push(w);const f=new i({rows:u}),x=new a({children:[new o({text:"ООО «Мос Солюшнс», УНП 193479009",color:"#000000",font:"Arial",size:21,bold:!0})],alignment:b.LEFT,heading:s.HEADING_3,spacing:{after:50}}),y=new a({children:[new o({text:"РБ, г. Минск, пер. С. Ковалевской, 62",color:"#000000",font:"Arial",size:21,bold:!0})],alignment:b.LEFT,heading:s.HEADING_3,spacing:{after:50}}),N=new a({children:[new o({text:"Р/c BY35PJCB30120644421000000933",color:"#000000",font:"Arial",size:21,bold:!0})],alignment:b.LEFT,heading:s.HEADING_3,spacing:{after:50}}),T=new a({children:[new o({text:'в "Приорбанк" ОАО, БИК PJCBBY2X,',color:"#000000",font:"Arial",size:21,bold:!0})],alignment:b.LEFT,heading:s.HEADING_3,spacing:{after:50}}),v=new a({children:[new o({text:"г. Минск, пр-т Дзержинского, 104",color:"#000000",font:"Arial",size:21,bold:!0})],alignment:b.LEFT,heading:s.HEADING_3,spacing:{after:50}}),P=new a({children:[new r({data:"data:image/jpeg;base64,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",transformation:{width:90,height:90},floating:{horizontalPosition:{relative:A.MARGIN,align:p.RIGHT},verticalPosition:{relative:E.MARGIN,align:g.TOP}}})]}),C=new a({children:[new o({text:`Счет №${t} от ${dateProvider()} г.`,bold:!0,color:"#000000",font:"Arial"})],alignment:b.CENTER,heading:s.HEADING_1,spacing:{after:600,before:600}}),D=new a({children:[new o({text:`Плательщик: ${formData.companyName}, `,font:"Arial",italics:!0,bold:!0}),new o({text:`УНП: ${formData.unp}, адрес: `,font:"Arial",italics:!0,bold:!0}),new o({text:`${formData.index?`${formData.index}, `:""}`,font:"Arial",italics:!0,bold:!0}),new o({text:`${formData.country?`${formData.country}`:""}`,font:"Arial",italics:!0,bold:!0}),new o({text:`${formData.city?`, ${formData.city}`:""}`,font:"Arial",italics:!0,bold:!0}),new o({text:`${formData.address?`, ${formData.address}`:""}`,font:"Arial",italics:!0,bold:!0}),new o({text:`${formData.phone?`, тел: ${formData.phone}`:""}`,font:"Arial",italics:!0,bold:!0})],alignment:b.LEFT,spacing:{line:300}}),B=new a({children:[new o({text:`Р/сч: ${formData.bill} `,font:"Arial",italics:!0,bold:!0}),new o({text:`в ${formData.bank} `,font:"Arial",italics:!0,bold:!0}),new o({text:`код ${formData.bic}`,font:"Arial",italics:!0,bold:!0})],alignment:b.LEFT,spacing:{after:300}}),S=new a({children:[new o({text:"Цель приобретения: Для собственного производства и/или потребления",font:"Arial",italics:!0})],alignment:b.LEFT,spacing:{after:60}}),O=new a({children:[new o({text:"Счет действителен в течение трех банковских дней",font:"Arial",italics:!0})],alignment:b.LEFT,spacing:{after:300}}),F=new a({children:[new o({text:`Сумма НДС: ${rubles((.2*PAGE_OPTIONS.price).toFixed(2))}`,font:"Arial",bold:!0})],alignment:b.LEFT,spacing:{after:200,before:500}}),L=new a({children:[new o({text:`Всего к оплате с НДС: ${rubles((PAGE_OPTIONS.price+.2*PAGE_OPTIONS.price).toFixed(2))}`,font:"Arial",bold:!0})],alignment:b.LEFT}),R=new a({children:[new o({text:"Директор __________________ (Странадкина Е.С.)",font:"Arial",bold:!0})],alignment:b.LEFT,spacing:{before:1500}}),k=new n({creator:"Moth.by",title:`Счет №${t}`,sections:[{children:[x,y,N,T,v,P,C,D,B,S,O,f,F,L,R]}]});return e.toBlob(k).then(e=>{saveAs(e,`Заказ №${t}.docx`)}),k},sendPayment=async t=>{const e=await docx.Packer.toBase64String(createDoc(t)).then(t=>t),n=`<center>\n            <table border='0' cellpadding='0' cellspacing='0' width='100%'\n                   style='font-family: Arial, sans-serif; font-size: 14px; width: 100%; max-width: 980px; margin: 0 auto; padding: 0; border-collapse: collapse;'>\n                <thead>\n                    <tr>\n                        <th align='left' colspan='10'>\n                            <img src='https://moth.by/images/ms.jpg'\n                                width='600'\n                                style="max-width:600px;padding-bottom:0;display:inline!important;vertical-align:bottom;border:0;height:auto;outline:none;text-decoration:none"\n                                alt='logo'/>\n                        </th>\n                        <th align='right' colspan='5' style='text-align: right; font-size: 14px'>\n                            <p>+375 (29) 666-39-93</p>\n                        </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr style='height: 32px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='15' style='padding: 0'>\n                            <span style='font-size: 14px'>Благодарим за интерес к нашей продукции! Ваш заказ получен и поступит в обработку в ближайшее время.</span>\n                        </td>\n                    </tr>\n                    <tr style='height: 24px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='15' style='background: #F8F8F8; padding: 12px; text-align: left; border: 1px solid #D8D8D8;'>\n                            <b>Детализация заказа</b>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td colspan='10' valign='top' style='min-width: 70%; border: 1px solid #D8D8D8; border-collapse: collapse; padding: 12px 12px 12px 12px'>\n                            <p style='margin: 0; margin-bottom: 12px'><b>№ заказа:</b> ${t}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Дата заказа:</b> ${dateProvider()}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Доставка:</b> ${formData.delivery?"Да":"Нет"}</p>\n                            ${formData.delivery?`<div>\n                                    <p style='margin: 0; margin-bottom: 12px'><b>Адрес доставки:</b></p>\n                                    <p style='margin: 0;'>${formData.deliveryCountry+", "}${formData.deliveryCity+", "}${formData.deliveryIndex?formData.deliveryIndex+", ":""}${formData.deliveryAddress}</p>\n                                </div>`:""}\n                        </td>\n                        <td colspan='5' valign='top' style='border: 1px solid #D8D8D8; border-collapse: collapse; padding: 12px 12px 12px 12px'>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Телефон:</b> ${formData.phone?formData.phone:""}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Email:</b> ${formData.email}</p>\n                        </td>\n                    </tr>\n                    <tr style='height: 24px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='8' style='background: #F8F8F8; padding: 12px; text-align: left; border: 1px solid #D8D8D8;'>\n                            <b>Название товара</b>\n                        </td>\n                        <td colspan='1' style='background: #F8F8F8; padding: 12px; text-align: center; border: 1px solid #D8D8D8;'>\n                            <b>Кол-во (шт.)</b>\n                        </td>\n                        <td colspan='3' style='background: #F8F8F8; padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>Цена</b>\n                        </td>\n                        <td colspan='3' style='background: #F8F8F8; padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>Итого</b>\n                        </td>\n                    </tr>\n                    ${PAGE_OPTIONS.basketList.map(t=>`<tr>\n                            <td colspan='8' style='padding: 12px; text-align: left; border: 1px solid #D8D8D8;'>\n                                <span>${t.name}</span>\n                            </td>\n                            <td colspan='1' style='padding: 12px; text-align: center; border: 1px solid #D8D8D8;'>\n                                <span>${t.count}</span>\n                            </td>\n                            <td colspan='3' style=' padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                                <span>${t.cost} BYN</span>\n                            </td>\n                            <td colspan='3' style='padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                                <span>${t.allCost} BYN</span>\n                            </td>\n                        </tr>`).join("")}\n                    <tr>\n                        <td colspan='12' style='padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>Итого:</b>\n                        </td>\n                        <td colspan='3' style='padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>${PAGE_OPTIONS.price.toFixed(2)} BYN</b>\n                        </td>\n                    </tr>\n                    <tr style='height: 24px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='15' style='padding: 0'>\n                            <p style='font-size: 14px'>Цена указана без учета НДС</p>\n                            <p style='font-size: 14px'>Если у Вас есть какие-либо вопросы, ответьте на это сообщение или позвоните нам.</p>\n                        </td>\n                    </tr>\n                    <tr style='height: 12px; width: 100%'></tr>\n                </tbody>\n            </table>\n        </center>`,i=`<center>\n            <table border='0' cellpadding='0' cellspacing='0' width='100%'\n                   style='font-family: Arial, sans-serif; font-size: 14px; width: 100%; max-width: 980px; margin: 0 auto; padding: 0; border-collapse: collapse;'>\n                <thead>\n                    <tr>\n                        <th align='left' colspan='15'>\n                            <img src='https://moth.by/images/ms.jpg'\n                                width='600'\n                                style="max-width:600px;padding-bottom:0;display:inline!important;vertical-align:bottom;border:0;height:auto;outline:none;text-decoration:none"\n                                alt='logo'/>\n                        </th>\n                    </tr>\n                </thead>\n                <tbody>\n                    <tr style='height: 32px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='15' style='background: #F8F8F8; padding: 12px; text-align: left; border: 1px solid #D8D8D8;'>\n                            <b>Детализация заказа</b>\n                        </td>\n                    </tr>\n                    <tr>\n                        <td colspan='10' valign='top' style='min-width: 70%; border: 1px solid #D8D8D8; border-collapse: collapse; padding: 12px 12px 12px 12px'>\n                            <p style='margin: 0; margin-bottom: 12px'><b>№ заказа:</b> ${t}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Дата заказа:</b> ${dateProvider()}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Доставка:</b> ${formData.delivery?"Да":"Нет"}</p>\n                            ${formData.delivery?`<div>\n                                    <p style='margin: 0; margin-bottom: 12px'><b>Адрес доставки:</b></p>\n                                    <p style='margin: 0;'>${formData.deliveryCountry+", "}${formData.deliveryCity+", "}${formData.deliveryIndex?formData.deliveryIndex+", ":""}${formData.deliveryAddress}</p>\n                                </div>`:""}\n                        </td>\n                        <td colspan='5' valign='top' style='border: 1px solid #D8D8D8; border-collapse: collapse; padding: 12px 12px 12px 12px'>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Телефон:</b> ${formData.phone?formData.phone:""}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Email:</b> ${formData.email}</p>\n                            <p style='margin: 0; margin-bottom: 12px'><b>Название компании:</b></p>\n                            <p style='margin: 0;'>${formData.companyName}</p>\n                        </td>\n                    </tr>\n                    <tr style='height: 24px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='8' style='background: #F8F8F8; padding: 12px; text-align: left; border: 1px solid #D8D8D8;'>\n                            <b>Название товара</b>\n                        </td>\n                        <td colspan='1' style='background: #F8F8F8; padding: 12px; text-align: center; border: 1px solid #D8D8D8;'>\n                            <b>Кол-во (шт.)</b>\n                        </td>\n                        <td colspan='3' style='background: #F8F8F8; padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>Цена</b>\n                        </td>\n                        <td colspan='3' style='background: #F8F8F8; padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>Итого</b>\n                        </td>\n                    </tr>\n                    ${PAGE_OPTIONS.basketList.map(t=>`<tr>\n                            <td colspan='8' style='padding: 12px; text-align: left; border: 1px solid #D8D8D8;'>\n                                <span>${t.name}</span>\n                            </td>\n                            <td colspan='1' style='padding: 12px; text-align: center; border: 1px solid #D8D8D8;'>\n                                <span>${t.count}</span>\n                            </td>\n                            <td colspan='3' style=' padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                                <span>${t.cost} BYN</span>\n                            </td>\n                            <td colspan='3' style='padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                                <span>${t.allCost} BYN</span>\n                            </td>\n                        </tr>`).join("")}\n                    <tr>\n                        <td colspan='12' style='padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>Итого:</b>\n                        </td>\n                        <td colspan='3' style='padding: 12px; text-align: right; border: 1px solid #D8D8D8;'>\n                            <b>${PAGE_OPTIONS.price.toFixed(2)} BYN</b>\n                        </td>\n                    </tr>\n                    <tr style='height: 24px; width: 100%'></tr>\n                    <tr>\n                        <td colspan='15' style='padding: 0'>\n                            <p style='font-size: 14px'>Цена указана без учета НДС</p>\n                        </td>\n                    </tr>\n                    <tr style='height: 12px; width: 100%'></tr>\n                </tbody>\n            </table>\n        </center>`;Email.send({SecureToken:"cbf761d5-b401-40a3-b789-fdddf5ff3705",To:"moth.by@gmail.com",From:"website@gmail.com",Subject:`Заказ №${t}`,Body:i,Attachments:[{name:`Заказ №${t}.docx`,data:e}]}).then(t=>{console.log(t),console.log("--------- bussiness ---------")}),Email.send({SecureToken:"cbf761d5-b401-40a3-b789-fdddf5ff3705",To:formData.email,From:"moth.by@gmail.com",Subject:`Ваш заказ №${t}`,Body:n,Attachments:[{name:`Заказ №${t}.docx`,data:e}]}).then(t=>{console.log(t),console.log("--------- client ---------"),document.querySelector(".thanks-popup-wrapper").classList.remove("hidden"),preloadHandler(!1)})};